;半成品版本，少一层壳，反调试不是很好
assume cs:code

code	segment
	db 25,?,25 dup (0)
	db 33 dup (0)
	db 33 dup (0)
	db 55h,6Fh,6EH,5AH,45H,60H,45H,45H,54H,51H,5DH,45H,64H,45H,4EH,5DH,5BH,6BH,4BH,79H,4BH,76H,48H,3CH,40H,7EH,54H,77H,7EH,6FH,40H,74H,0
	db "you got it",'$'
	db "try again",'$'
start:
	mov ax,code
	mov ds,ax
	mov ss,ax
	mov sp,offset xorEnd
	sub sp,2
	mov bp,sp
	
xor_loop:
	mov ax,[bp]
	xor [bp-2],ax
	sub bp,2
	sub sp,2

	cmp bp,offset xorCode
	jz xorcode

	jmp xor_loop
	
	;mov ax,[si]
	;xor [si-2],ax
	;sub si,2

	;cmp si,offset xorCode
	;jz aaaa ;xorCode
	;jmp xor_loop


xorCode:
	db 55, 69, 188, 130, 224, 190, 97, 189, 130, 232, 188, 105, 191
	db 130, 248, 131, 134, 128, 105, 117, 17, 179, 3, 198, 238, 101
	db 123, 61, 220, 109, 91, 34, 172, 22, 187, 232, 230, 232, 87, 3
	db 99, 226, 99, 228, 99, 232, 208, 40, 138, 193, 8, 123, 130, 84
	db 119, 45, 179, 66, 199, 69, 234, 65, 123, 25, 220, 109, 91, 34
	db 172, 21, 187, 235, 194, 232, 115, 5, 99, 228, 99, 226, 99, 238
	db 208, 40, 138, 129, 137, 197, 127, 131, 84, 118, 45, 179, 66, 196
	db 69, 233, 28, 123, 68, 165, 79, 34, 172, 20, 187, 234, 158, 232
	db 47, 7, 99, 230, 208, 36, 138, 129, 138, 198, 197, 128, 68, 198
	db 135, 46, 148, 138, 224, 63, 38, 63, 57, 5, 57, 6, 38, 52, 38, 53
	db 0, 6, 15, 59, 45, 19, 37, 117, 49, 108, 66, 0, 116, 0, 10, 1, 8
	db 22, 123, 61, 1, 46, 65, 6, 12, 13, 27, 37, 87, 24, 15, 48, 102, 5
	db 33, 55, 23, 49, 47, 43, 47, 56, 12, 16, 95, 55, 102, 5, 3, 39, 2
	db 96, 26, 66, 2, 31, 38, 56, 47, 54, 13, 51, 56, 61, 78, 46, 65, 5
	db 54, 14, 61, 37, 75, 6, 123, 23, 15, 11, 15, 50, 12, 44, 31, 44, 21
	db 36, 14, 55, 10, 23, 42, 1, 95, 50, 102, 5, 3, 63, 2, 120, 26, 66
	db 2, 31, 38, 56, 46, 54, 12, 51, 14, 61, 120, 46, 65, 5, 12, 14, 7
	db 37, 75, 6, 123, 23, 15, 11, 8, 50, 11, 53, 60, 31, 54, 14, 14, 55
	db 10, 27, 42, 25, 92, 35, 114, 50, 10, 53, 40, 31, 34, 14, 1, 29, 35
	db 40, 14, 60, 11, 84, 0, 121, 46, 42, 29, 42, 24, 46, 15, 6, 43, 60
	db 60, 27, 16, 43, 0, 92, 0, 64, 8, 43, 27, 17, 27, 9, 28, 44, 60, 81
	db 27, 3, 74, 117, 116, 121, 46, 121, 46, 42, 29, 42, 24, 50, 15, 26
	db 7, 58, 8, 9, 11, 25, 6, 59, 51, 50, 48, 126, 49, 123, 89, 31, 110
	db 19, 106, 27, 122, 27, 100, 10, 100, 10, 26, 1, 18, 45, 50, 32, 24
	db 29, 66, 22, 90, 32, 44, 80, 49, 103, 64, 53, 81, 37, 87, 0, 83, 115
	db 11, 6, 31, 95, 38, 28, 62, 30, 46, 31, 0, 26, 15, 39, 44, 46, 35, 51
	db 12, 100, 37, 96, 42, 60, 113, 46, 98, 16, 19, 100, 59, 125, 40, 27
	db 21, 30, 119, 12, 68, 16, 31, 30, 42, 62, 48, 52, 71, 7, 13, 17, 86
	db 5, 40, 38, 5, 5, 49, 50, 2, 5, 72, 17, 11, 5, 117, 38, 5, 92, 49
	db 109, 40, 3, 31, 12, 6, 58, 115, 30, 113, 62, 5, 124, 51, 109, 71, 2
	db 4, 20, 3, 17, 89, 16, 32, 54, 97, 20, 107, 23, 5, 17, 5, 94, 51, 121
	db 71, 17, 85, 40, 41, 68, 103, 68, 89, 68, 89, 67, 102, 67, 102, 67
	db 125, 67, 33, 18, 74, 146, 42, 244, 205, 109, 70, 242, 1, 27, 49, 201
	db 187, 234, 30, 123, 148, 81, 0, 13, 49, 206, 187, 233, 20, 123, 158
	db 113, 1, 59, 8, 33, 130, 143, 70, 247, 188, 129, 143, 71, 247, 190, 128
	db 143, 64, 244, 186, 225, 139, 104, 242, 224, 225, 105, 160, 154, 42, 60
	db 123, 166, 105, 193, 139, 71, 242, 239, 193, 2, 90, 123, 155, 105, 176
	db 139, 57, 242, 224, 176, 105, 241, 180, 42, 57, 123, 141, 105, 171, 140
	db 46, 196, 59, 90, 61, 123, 178, 175, 50, 196, 130, 143, 15, 247, 245, 129
	db 143, 9, 157, 184, 20, 90, 41, 20, 61, 8, 20, 30, 102, 0, 56, 123, 163, 144
xorEnd:

code	ends
end	start

